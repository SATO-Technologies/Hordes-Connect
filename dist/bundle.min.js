(()=>{"use strict";const e=()=>navigator.userAgent.match("iPad")||navigator.userAgent.match("iPhone")||navigator.userAgent.match("iPod")||navigator.userAgent.match("Android"),t="https://hordesconnect.bysato.com",s=new class{constructor(){this.app="",this.size={width:e()?window.innerWidth:350,height:e()?window.innerHeight:820,top:e()?0:window.innerHeight/2-410,left:e()?0:window.innerWidth/2-175}}initialize({app:e="",size:t}){this.app=e;const{top:s,left:i,width:a,height:n}=t||{};isNaN(s)||(this.size.top=+s),isNaN(i)||(this.size.left=+i),isNaN(a)||(this.size.width=+a),isNaN(n)||(this.size.height=+n)}async createRequest(e){try{let t=await fetch("https://api.bysato.com/hordesconnect/request.php",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}});return t=await t.json(),t&&t.requestId?t.requestId:null}catch{return null}}open(){return window.open(`${t}`,"_blank",`toolbar=no,scrollbars=no,resizable=no,top=${this.size.top},left=${this.size.left},width=${this.size.width},height=${this.size.height}}`)}update(e,s,i,a){e.location.href=`${t}/${s}?=msg=${i}`,window.addEventListener("message",(e=>{(e.originalEvent?.origin||e.origin).includes(t)&&a(JSON.parse(e.data))}))}getAddress({message:e="Address"}={}){let t=this.open();return new Promise((async(s,i)=>{try{let a=await this.createRequest({app:this.app,type:"address",message:e});a?this.update(t,a,e,(e=>{e&&"address"==e.type?s(e.payload):i({error:"unable to get address"})})):i({error:"unable to create request"})}catch(e){i({error:"unable to get address"})}}))}signTransaction({message:e="Sign Transaction",base64Psbt:t=null,broadcast:s=!1}){let i=this.open();return new Promise((async(a,n)=>{try{let r=await this.createRequest({app:this.app,type:"sign_transaction",message:e,base64Psbt:t,broadcast:s});r?this.update(i,r,e,(e=>{e&&"sign_transaction"==e.type?a(e.payload):n({error:"unable to sign transaction"})})):n({error:"unable to create request"})}catch{n({error:"unable to sign transaction"})}}))}mint({message:e="Inscribe Inscription",address:t,commitmentPsbt:s,revealTxData:i,fee:a}){let n=this.open();return new Promise((async(r,o)=>{try{let h=await this.createRequest({app:this.app,type:"mint_inscription",message:e,address:t,commitmentPsbt:s,revealTxData:i,fee:a});h?this.update(n,h,e,(e=>{e&&"mint_inscription"==e.type?r(e.payload):o({error:"unable to inscribe inscription"})})):o({error:"unable to create request"})}catch(e){o({error:"unable to inscribe inscription"})}}))}};window.HordesConnect=s})();