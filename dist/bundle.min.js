(()=>{"use strict";const t=()=>navigator.userAgent.match("iPad")||navigator.userAgent.match("iPhone")||navigator.userAgent.match("iPod")||navigator.userAgent.match("Android"),e="https://hordesconnect.bysato.com",s=new class{constructor(){this.app="",this.size={width:t()?window.innerWidth:350,height:t()?window.innerHeight:820,top:t()?0:window.innerHeight/2-410,left:t()?0:window.innerWidth/2-175}}initialize({app:t="",size:e}){this.app=t;const{top:s,left:i,width:a,height:n}=e||{};isNaN(s)||(this.size.top=+s),isNaN(i)||(this.size.left=+i),isNaN(a)||(this.size.width=+a),isNaN(n)||(this.size.height=+n)}async createRequest(t){try{let e=await fetch("https://api.bysato.com/hordesconnect/request.php",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}});return e=await e.json(),e&&e.requestId?e.requestId:null}catch{return null}}open(t,s){window.open(`${e}/${t}`,"_blank",`toolbar=no,scrollbars=no,resizable=no,top=${this.size.top},left=${this.size.left},width=${this.size.width},height=${this.size.height}}`),window.addEventListener("message",(t=>{(t.originalEvent?.origin||t.origin).includes(e)&&s(JSON.parse(t.data))}))}getAddress({message:t="Address"}={}){return new Promise((async(e,s)=>{try{let i=await this.createRequest({app:this.app,type:"address",message:t});i?this.open(i,(t=>{t&&"address"==t.type?e(t.payload):s({error:"unable to get address"})})):s({error:"unable to create request"})}catch(t){s({error:"unable to get address"})}}))}signTransaction({message:t="Sign Transaction",base64Psbt:e=null,broadcast:s=!1}){return new Promise((async(i,a)=>{try{let n=await this.createRequest({app:this.app,type:"sign_transaction",message:t,base64Psbt:e,broadcast:s});n?this.open(n,(t=>{t&&"sign_transaction"==t.type?i(t.payload):a({error:"unable to sign transaction"})})):a({error:"unable to create request"})}catch{a({error:"unable to sign transaction"})}}))}mint({message:t="Mint Inscription",commitmentPsbt:e,revealTxData:s,fee:i}){return new Promise((async(a,n)=>{try{let r=await this.createRequest({app:this.app,type:"mint_inscription",message:t,commitmentPsbt:e,revealTxData:s,fee:i});r?this.open(r,(t=>{t&&"mint_inscription"==t.type?a(t.payload):n({error:"unable to mint inscription"})})):n({error:"unable to create request"})}catch(t){n({error:"unable to mint inscription"})}}))}};window.HordesConnect=s})();